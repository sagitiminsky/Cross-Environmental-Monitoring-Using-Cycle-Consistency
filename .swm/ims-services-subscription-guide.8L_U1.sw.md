---
id: 8L_U1
name: IMS Services Subscription Guide
file_version: 1.0.2
app_version: 0.6.9-2
file_blobs:
  CellEnMon/libs/scrappers/ims_scrapper/scrapper.py: 83dded5fb7d8d0cb197d7dd3139fbea07684ec09
  CellEnMon/config.py: d1992676523a12462209a14105391f795681f4ed
---

TLDR: send go to [https://ims.gov.il/he/ObservationDataAPI](https://ims.gov.il/he/ObservationDataAPI) you will find the API documenation and you'll be able to fill in the following form [https://ims.gov.il/sites/default/files/docs/terms\_0.pdf](https://ims.gov.il/sites/default/files/docs/terms_0.pdf) and send it back to [&#105;&#109;&#115;&#64;&#x69;&#109;&#115;&#x2e;&#103;&#x6f;&#118;&#x2e;&#x69;&#x6c;](mailto:ims@ims.gov.il).

After receiving the approval from the ims you will be provided with an API Token, if you want, you can keep that in secret - put that in your gitignore file.

There is a designated requirements file - you don't need torch if you are only intrested in the ims data

`ðŸ“„ CellEnMon/libs/scrappers/ims_scrapper/requirements.txt`

<br/>

There are two options to run the script:  
1\. DOWNLOAD - download from the ims API endpoint  
2\. UPLOAD - uploads data to a managed bucket in my gcs
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ CellEnMon/libs/scrappers/ims_scrapper/scrapper.py
```python
ðŸŸ© 26     SELECTOR = ['DOWNLOAD']  # UPLOAD'
```

<br/>

you can use the following token to verify that everything works for you
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ CellEnMon/config.py
```python
ðŸŸ© 74     ims_token = 'f058958a-d8bd-47cc-95d7-7ecf98610e47'
ðŸŸ© 75     ims_mapping=[
â¬œ 76         {
â¬œ 77             "stationId": 2,
â¬œ 78             "name": "AVNE ETAN",
â¬œ 79             "shortName": "AVNE ETA",
â¬œ 80             "stationsTag": "(None)",
â¬œ 81             "location": {
â¬œ 82                 "latitude": 32.817,
â¬œ 83                 "longitude": 35.763
â¬œ 84             },
â¬œ 85             "timebase": 10,
â¬œ 86             "active": True,
â¬œ 87             "owner": "ims",
â¬œ 88             "regionId": 8,
â¬œ 89             "monitors": [
â¬œ 90                 {
```

<br/>

This is how we are going to GET from the ims endpoint
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ CellEnMon/libs/scrappers/ims_scrapper/scrapper.py
```python
â¬œ 27     class IMS_Scrapper_obj:
â¬œ 28         def __init__(self, index, station_id, station_name, location, _from, _to):
â¬œ 29             self.index = index
â¬œ 30             self.station_id = station_id
â¬œ 31             self._from = _from
â¬œ 32             self._to = _to
â¬œ 33             self.root = config.ims_root_files
â¬œ 34             self.station_id = station_id
â¬œ 35             self.station_name = station_name
â¬œ 36             self.station_location = location
ðŸŸ© 37             self.station_data = f"https://api.ims.gov.il/v1/envista/stations/{station_id}/data/?from={_from}&to={_to}"
â¬œ 38             self.bucket = client.get_bucket('cell_en_mon')
```

<br/>

If you download the files locally, you will see it in the following path: /CellEnMon/datasets/ims/raw/

<br/>

To control the dates in the ims, you can change the dates in the config file:
<!-- NOTE-swimm-snippet: the lines below link your snippet to Swimm -->
### ðŸ“„ CellEnMon/config.py
```python
â¬œ 24         }
â¬œ 25     
â¬œ 26     
ðŸŸ© 27     date = {
ðŸŸ© 28         'value': {
ðŸŸ© 29             'dd': '01',
ðŸŸ© 30             'mm': '01',
ðŸŸ© 31             'yyyy': '2013'
ðŸŸ© 32         },
ðŸŸ© 33         'value_range': {
ðŸŸ© 34             'dd': '02',
ðŸŸ© 35             'mm': '01',
ðŸŸ© 36             'yyyy': '2013'
ðŸŸ© 37         }
ðŸŸ© 38     }
â¬œ 39     
â¬œ 40     date_str_rep = add_days_to_date(date['value'])['str_rep_with_replace'] + '_' + add_days_to_date(date['value_range'])[
â¬œ 41         'str_rep_with_replace']
```

<br/>

This file was generated by Swimm. [Click here to view it in the app](https://app.swimm.io/repos/Z2l0aHViJTNBJTNBQ2VsbEVuTW9uLVJlc2VhcmNoJTNBJTNBc2FnaXRpbWluc2t5/docs/8L_U1).